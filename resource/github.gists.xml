<?xml version="1.0" encoding="UTF-8"?>
<table xmlns="http://query.yahooapis.com/v1/schema/table.xsd">
  <meta>
    <author>Irakli Gozalishvili</author>
    <documentationURL></documentationURL>
    <sampleQuery>
        use "https://gist.github.com/raw/9b427dd1b238aa1c16db/97814f091953736822790cdf1a4cd8a2aa8d6813/github.gist.xml";
        select * from github.gists where user="gozala"
    </sampleQuery>
  </meta>
  <bindings>
    <select itemPath="json.gists" produces="JSON">
      <urls>
        <url>http://gist.github.com/api/v1/json/gists/{user}</url>
      </urls>
      <inputs>
        <key id="user" type="xs:string" paramType="path" required="true"/>
      </inputs>
    </select>
    <insert itemPath="" produces="JSON">
        <urls>
            <url>http://gist.github.com/gists/</url>
        </urls>
        <inputs>
            <key id="user" type="xs:string" paramType="variable" required="true"/>
            <key id="token" type="xs:string" paramType="variable" required="true"/>
            <key id="name" type="xs:string" paramType="variable" required="true"/>
            <key id="content" type="xs:string" paramType="variable" required="true"/>
            <key id="extension" type="xs:string" paramType="variable" required="false"/>
            <key id="isPrivate" type="xs:boolean" paramType="variable" required="false"/>
        </inputs>
        <execute><![CDATA[
            var data = (isPrivate) ? "action_button=private&" : "";
            data += "login=" + user + "&token=" + token + "&";
            data += "file_name[gistfile1]=" + encodeURIComponent(name) + "&"
                + "file_ext[gistfile1]=" + encodeURIComponent(extension) + "&"
                + "file_contents[gistfile1]=" + encodeURIComponent(content);
            var html = request
                .header("Content-type","application/x-www-form-urlencoded")
                .header("Accept", "text/javascript")
                .post(data)
                .response;
            response.object = { id: /gist: (\w*) /.exec(html)[1] };
        ]]></execute>
    </insert>
  </bindings>
</table>
